# å‰è¨€
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é²«å°é±¼ã€‚æ˜¯ä¸€å`ä¸å†™å‰ç«¯ä»£ç `çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçƒ­è¡·äºåˆ†äº«éå‰ç«¯çš„çŸ¥è¯†ï¼Œå¸¦é¢†åˆ‡å›¾ä»”é€ƒç¦»åˆ‡å›¾åœˆå­ï¼Œæ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼

# ç¬¬åå…­ç« ï¼šNext.js ä¸­çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆ

## ç†è®ºè®²è§£

### 1. Next.js åº”ç”¨ä¸­çš„çŠ¶æ€ç®¡ç†éœ€æ±‚
- Next.js æ”¯æŒ SSRã€SSGã€CSRã€ISR ç­‰å¤šç§æ¸²æŸ“æ¨¡å¼ï¼ŒçŠ¶æ€ç®¡ç†éœ€å…¼å®¹æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ã€‚
- ä¼ä¸šçº§é¡¹ç›®å¸¸è§çŠ¶æ€ç±»å‹ï¼šå…¨å±€çŠ¶æ€ï¼ˆå¦‚ç”¨æˆ·ä¿¡æ¯ã€ä¸»é¢˜ã€æƒé™ï¼‰ã€å±€éƒ¨çŠ¶æ€ï¼ˆå¦‚è¡¨å•ã€å¼¹çª—ï¼‰ã€å¼‚æ­¥æ•°æ®ï¼ˆå¦‚æ¥å£æ•°æ®ã€WebSocket å®æ—¶æ•°æ®ï¼‰ã€æŒä¹…åŒ–çŠ¶æ€ï¼ˆå¦‚æœ¬åœ°å­˜å‚¨ã€Cookieï¼‰ã€‚
- çŠ¶æ€ç®¡ç†çš„æŒ‘æˆ˜ï¼šæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯åŒæ­¥ã€æ€§èƒ½ä¼˜åŒ–ã€å¯ç»´æŠ¤æ€§ã€å›¢é˜Ÿåä½œã€ç±»å‹å®‰å…¨ã€æŒä¹…åŒ–ã€ä¸åç«¯åä½œã€‚

### 2. ä¸»æµçŠ¶æ€ç®¡ç†æ–¹æ¡ˆå¯¹æ¯”
- **Context API**ï¼šReact å†…ç½®ï¼Œé€‚åˆç®€å•å…¨å±€çŠ¶æ€ï¼Œæ€§èƒ½æœ‰é™ã€‚
- **Redux Toolkit**ï¼šä¼ä¸šçº§æ ‡å‡†ï¼Œå¼ºå¤§ç”Ÿæ€ï¼Œæ”¯æŒä¸­é—´ä»¶ã€æŒä¹…åŒ–ã€DevToolsï¼Œé€‚åˆå¤æ‚ä¸šåŠ¡ã€‚
- **Zustand**ï¼šè½»é‡ã€æç®€ã€TypeScript å‹å¥½ï¼Œå¤©ç„¶æ”¯æŒ SSR/Next.jsï¼Œé€‚åˆä¸­å°å‹é¡¹ç›®å’Œå±€éƒ¨å…¨å±€çŠ¶æ€ã€‚
- **Recoil**ï¼šåŸå­åŒ–çŠ¶æ€ï¼Œé€‚åˆå¤æ‚ç»„ä»¶æ ‘ï¼Œæ˜“äºç»„åˆã€‚
- **Jotai/MobX**ï¼šå“åº”å¼ã€æç®€ï¼Œé€‚åˆç‰¹å®šåœºæ™¯ã€‚
- **SWR/React Query**ï¼šä¸“æ³¨å¼‚æ­¥æ•°æ®è·å–ä¸ç¼“å­˜ï¼Œé€‚åˆæ¥å£æ•°æ®ç®¡ç†ã€‚
- æ¨èç»„åˆï¼šZustand/Redux ç®¡ç†å…¨å±€ä¸šåŠ¡çŠ¶æ€ï¼ŒSWR/React Query ç®¡ç†å¼‚æ­¥æ•°æ®ã€‚

### 3. çŠ¶æ€æŒä¹…åŒ–ä¸æœåŠ¡ç«¯åä½œ
- çŠ¶æ€æŒä¹…åŒ–ï¼šlocalStorageã€sessionStorageã€IndexedDBã€Cookieï¼Œå¸¸ç”¨äºä¸»é¢˜ã€Tokenã€è‰ç¨¿ç­‰ã€‚
- SSR/SSG/ISR åœºæ™¯ä¸‹ï¼Œéœ€æ³¨æ„æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çŠ¶æ€åŒæ­¥ã€‚
- çŠ¶æ€ä¸ Server Actionsã€API Routes åä½œï¼šå¦‚å…¨å±€çŠ¶æ€å˜æ›´åè‡ªåŠ¨åˆ·æ–°é¡µé¢ã€æ¨é€é€šçŸ¥ç­‰ã€‚

### 4. ä¼ä¸šçº§çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ
- çŠ¶æ€æ‹†åˆ†ï¼šå…¨å±€/å±€éƒ¨/å¼‚æ­¥/æŒä¹…åŒ–åˆ†å±‚ç®¡ç†ï¼Œé¿å…â€œå¤§ä¸€ç»Ÿâ€Storeã€‚
- ç±»å‹å®‰å…¨ï¼šTypeScript å…¨é¢çº¦æŸï¼Œå‡å°‘è¿è¡Œæ—¶é”™è¯¯ã€‚
- æ€§èƒ½ä¼˜åŒ–ï¼šé¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼ŒæŒ‰éœ€è®¢é˜…ã€æ‡’åŠ è½½ã€åˆ†ç‰‡æ›´æ–°ã€‚
- å›¢é˜Ÿåä½œï¼šç»Ÿä¸€ç›®å½•ç»“æ„ã€å‘½åè§„èŒƒã€ä»£ç å®¡æŸ¥ã€è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
- çŠ¶æ€ç›‘æ§ä¸è°ƒè¯•ï¼šé›†æˆ Redux DevToolsã€LogRocketã€Sentry ç­‰ã€‚

---

## è¯¦ç»†ä»£ç ç¤ºä¾‹

### 1. ä½¿ç”¨ Zustand ç®¡ç†å…¨å±€ä¸»é¢˜æ¨¡å¼

```ts
// stores/theme.ts
import create from 'zustand';

type ThemeState = {
  mode: 'light' | 'dark';
  toggle: () => void;
};

export const useThemeStore = create<ThemeState>((set) => ({
  mode: 'light',
  toggle: () => set((state) => ({ mode: state.mode === 'light' ? 'dark' : 'light' })),
}));
```

```tsx
// components/ThemeToggle.tsx
import { useThemeStore } from '../stores/theme';

export default function ThemeToggle() {
  const mode = useThemeStore((s) => s.mode);
  const toggle = useThemeStore((s) => s.toggle);
  return (
    <button onClick={toggle} aria-label="åˆ‡æ¢ä¸»é¢˜" className="p-2">
      å½“å‰æ¨¡å¼ï¼š{mode === 'light' ? 'äº®è‰²' : 'æš—è‰²'}
    </button>
  );
}
```

### 2. Redux Toolkit ç®¡ç†å¤æ‚ä¸šåŠ¡çŠ¶æ€

```ts
// stores/userSlice.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface UserState {
  name: string;
  role: string;
  token: string;
}

const initialState: UserState = { name: '', role: '', token: '' };

const userSlice = createSlice({
  name: 'user',
  initialState,
  reducers: {
    setUser(state, action: PayloadAction<UserState>) {
      return { ...state, ...action.payload };
    },
    clearUser() {
      return initialState;
    },
  },
});

export const { setUser, clearUser } = userSlice.actions;
export default userSlice.reducer;
```

```ts
// stores/index.ts
import { configureStore } from '@reduxjs/toolkit';
import userReducer from './userSlice';

export const store = configureStore({
  reducer: { user: userReducer },
});

export type RootState = ReturnType<typeof store.getState>;
export type AppDispatch = typeof store.dispatch;
```

```tsx
// pages/_app.tsx
import { Provider } from 'react-redux';
import { store } from '../stores';

export default function App({ Component, pageProps }) {
  return (
    <Provider store={store}>
      <Component {...pageProps} />
    </Provider>
  );
}
```

### 3. çŠ¶æ€æŒä¹…åŒ–ä¸ SSR åä½œ

```ts
// stores/theme.ts (æŒä¹…åŒ–)
import create from 'zustand';
import { persist } from 'zustand/middleware';

export const useThemeStore = create(persist(
  (set) => ({
    mode: 'light',
    toggle: () => set((state) => ({ mode: state.mode === 'light' ? 'dark' : 'light' })),
  }),
  { name: 'theme-mode' }
));
```

```tsx
// pages/_document.tsx (SSR åŒæ­¥ä¸»é¢˜)
import { Html, Head, Main, NextScript } from 'next/document';
export default function Document() {
  return (
    <Html>
      <Head />
      <body className="bg-white dark:bg-black">
        <Main />
        <NextScript />
      </body>
    </Html>
  );
}
```

### 4. Recoil åŸå­åŒ–çŠ¶æ€ç®¡ç†

```ts
// stores/atoms.ts
import { atom } from 'recoil';

export const counterAtom = atom<number>({
  key: 'counter',
  default: 0,
});
```

```tsx
// components/Counter.tsx
import { useRecoilState } from 'recoil';
import { counterAtom } from '../stores/atoms';

export default function Counter() {
  const [count, setCount] = useRecoilState(counterAtom);
  return (
    <div>
      <button onClick={() => setCount(count - 1)}>-</button>
      <span>{count}</span>
      <button onClick={() => setCount(count + 1)}>+</button>
    </div>
  );
}
```

### 5. SWR/React Query ç®¡ç†å¼‚æ­¥æ•°æ®

```tsx
// components/UserProfile.tsx
import useSWR from 'swr';

const fetcher = (url) => fetch(url).then((res) => res.json());

export default function UserProfile() {
  const { data, error, isLoading } = useSWR('/api/user', fetcher);
  if (isLoading) return <div>åŠ è½½ä¸­...</div>;
  if (error) return <div>åŠ è½½å¤±è´¥</div>;
  return <div>ç”¨æˆ·åï¼š{data.name}</div>;
}
```

---

## å®æˆ˜é¡¹ç›®ï¼šå®æ—¶é€šçŸ¥ä¸­å¿ƒ

### 1. éœ€æ±‚åˆ†æ
- å…¨å±€ç®¡ç†æ¶ˆæ¯æ•°æ®ï¼Œæ”¯æŒæœªè¯»è®¡æ•°ã€æ¶ˆæ¯æ ‡è®°ä¸ºå·²è¯»ã€WebSocket å®æ—¶æ¨é€ã€‚
- æ”¯æŒç§»åŠ¨ç«¯é€‚é…ã€a11yã€å›½é™…åŒ–ã€æ€§èƒ½ä¼˜åŒ–ã€é”™è¯¯å¤„ç†ã€‚
- ä¸åç«¯/Server Actions åä½œï¼Œæ¶ˆæ¯çŠ¶æ€æŒä¹…åŒ–ã€‚

### 2. ç›®å½•ç»“æ„
```
stores/
  notification.ts
components/
  NotificationList.tsx
  NotificationBell.tsx
pages/
  dashboard.tsx
api/
  notifications.ts
```

### 3. å…³é”®ä»£ç ç‰‡æ®µ
- ç”¨ Zustand ç®¡ç†å…¨å±€æ¶ˆæ¯çŠ¶æ€ï¼ŒSWR æ‹‰å–å†å²æ¶ˆæ¯ï¼ŒWebSocket æ¨é€æ–°æ¶ˆæ¯ã€‚
- æ¶ˆæ¯å·²è¯»çŠ¶æ€åŒæ­¥åˆ°åç«¯ï¼Œæœªè¯»è®¡æ•°å…¨å±€å±•ç¤ºã€‚
- ç»„ä»¶å“åº”å¼å¸ƒå±€ï¼Œæ”¯æŒç§»åŠ¨ç«¯å’Œæ— éšœç¢ã€‚

```ts
// stores/notification.ts
import create from 'zustand';

type Notification = { id: string; content: string; read: boolean };
type NotificationState = {
  list: Notification[];
  unread: number;
  add: (n: Notification) => void;
  markRead: (id: string) => void;
  setList: (list: Notification[]) => void;
};

export const useNotificationStore = create<NotificationState>((set) => ({
  list: [],
  unread: 0,
  add: (n) => set((s) => ({ list: [n, ...s.list], unread: s.unread + 1 })),
  markRead: (id) => set((s) => {
    const list = s.list.map((n) => n.id === id ? { ...n, read: true } : n);
    return { list, unread: list.filter((n) => !n.read).length };
  }),
  setList: (list) => set({ list, unread: list.filter((n) => !n.read).length }),
}));
```

```tsx
// components/NotificationBell.tsx
import { useNotificationStore } from '../stores/notification';

export default function NotificationBell() {
  const unread = useNotificationStore((s) => s.unread);
  return (
    <button aria-label="é€šçŸ¥" className="relative">
      <span>ğŸ””</span>
      {unread > 0 && <span className="badge">{unread}</span>}
    </button>
  );
}
```

```tsx
// components/NotificationList.tsx
import { useNotificationStore } from '../stores/notification';

export default function NotificationList() {
  const list = useNotificationStore((s) => s.list);
  const markRead = useNotificationStore((s) => s.markRead);
  return (
    <ul>
      {list.map((n) => (
        <li key={n.id} className={n.read ? 'read' : 'unread'}>
          {n.content}
          {!n.read && <button onClick={() => markRead(n.id)}>æ ‡è®°ä¸ºå·²è¯»</button>}
        </li>
      ))}
    </ul>
  );
}
```

---

## ç†è®ºè®²è§£ï¼ˆè¿›é˜¶æ‰©å±•ï¼‰

### 5. çŠ¶æ€æå‡ä¸ä¸‹æ²‰ã€éš”ç¦»ä¸ä½œç”¨åŸŸ
- çŠ¶æ€æå‡ï¼šå°†å±€éƒ¨çŠ¶æ€æå‡åˆ°æœ€è¿‘çš„å…¬å…±çˆ¶ç»„ä»¶ï¼Œå®ç°å…„å¼Ÿç»„ä»¶é€šä¿¡ã€‚
- çŠ¶æ€ä¸‹æ²‰ï¼šå°†å…¨å±€çŠ¶æ€æ‹†åˆ†ä¸ºå±€éƒ¨çŠ¶æ€ï¼Œå‡å°‘ä¸å¿…è¦çš„å…¨å±€ä¾èµ–ã€‚
- çŠ¶æ€éš”ç¦»ï¼šé€šè¿‡ Contextã€Providerã€ä½œç”¨åŸŸ Store å®ç°å¤šå®ä¾‹éš”ç¦»ï¼ˆå¦‚å¤šå¼¹çª—ã€åµŒå¥—è¡¨å•ï¼‰ã€‚
- ä½œç”¨åŸŸ Storeï¼šå¦‚ Recoil çš„ Scopeã€Zustand çš„ createStoreï¼Œæ”¯æŒå¤šç§Ÿæˆ·/å¤šå®ä¾‹ã€‚

### 6. è·¨é¡µé¢/å¤šæ ‡ç­¾åŒæ­¥ä¸ä¸€è‡´æ€§
- å¤šæ ‡ç­¾/å¤šçª—å£åŒæ­¥ï¼šç”¨ BroadcastChannelã€localStorage äº‹ä»¶ã€Service Worker å®ç°ã€‚
- çŠ¶æ€ä¸€è‡´æ€§ï¼šå¦‚ç”¨æˆ·ç™»å‡ºã€Token å¤±æ•ˆã€å…¨å±€é€šçŸ¥ç­‰éœ€å¤šæ ‡ç­¾åŒæ­¥ã€‚
- ç¤ºä¾‹ï¼šç”¨æˆ·åœ¨Aæ ‡ç­¾é¡µç™»å‡ºï¼ŒBæ ‡ç­¾é¡µè‡ªåŠ¨åŒæ­¥ç™»å‡ºã€‚

### 7. çŠ¶æ€å®‰å…¨ã€æƒé™ä¸å›½é™…åŒ–
- çŠ¶æ€å®‰å…¨ï¼šToken/æ•æ„Ÿä¿¡æ¯ä»…å­˜å†…å­˜æˆ– HttpOnly Cookieï¼Œé˜²æ­¢XSS/CSRFã€‚
- æƒé™æ§åˆ¶ï¼šå…¨å±€çŠ¶æ€ä¸­å­˜å‚¨ç”¨æˆ·è§’è‰²/æƒé™ï¼Œç»„ä»¶/è·¯ç”±æŒ‰æƒé™æ¸²æŸ“ã€‚
- å›½é™…åŒ–/å¤šç§Ÿæˆ·ï¼šå…¨å±€çŠ¶æ€å­˜å‚¨å½“å‰è¯­è¨€ã€ç§Ÿæˆ·IDï¼Œæ”¯æŒå¤šè¯­è¨€/å¤šç§Ÿæˆ·åˆ‡æ¢ã€‚

### 8. çŠ¶æ€ä¸å¼‚æ­¥æµã€ç¼“å­˜å¤±æ•ˆã€ç°åº¦å‘å¸ƒ
- WebSocket/SSE/GraphQLè®¢é˜…ï¼šå…¨å±€çŠ¶æ€ä¸å®æ—¶æ•°æ®æµåä½œï¼Œè‡ªåŠ¨æ¨é€/åˆ·æ–°ã€‚
- ç¼“å­˜å¤±æ•ˆ/æ‰‹åŠ¨åˆ·æ–°ï¼šå¦‚ React Query/SWR çš„ mutateã€invalidateQueriesã€‚
- ç°åº¦å‘å¸ƒ/ABæµ‹è¯•ï¼šå…¨å±€çŠ¶æ€å­˜å‚¨å®éªŒåˆ†ç»„ï¼ŒæŒ‰åˆ†ç»„æ¸²æŸ“ä¸åŒUI/åŠŸèƒ½ã€‚

---

## å¤æ‚ä»£ç ç¤ºä¾‹ä¸ä¼ä¸šçº§åœºæ™¯

### 6. å¤šæ ‡ç­¾/å¤šçª—å£çŠ¶æ€åŒæ­¥

```ts
// hooks/useBroadcast.ts
import { useEffect } from 'react';
export function useBroadcast(key: string, onMessage: (data: any) => void) {
  useEffect(() => {
    const bc = new BroadcastChannel(key);
    bc.onmessage = (e) => onMessage(e.data);
    return () => bc.close();
  }, [key, onMessage]);
}

// åœ¨å…¨å±€çŠ¶æ€å˜æ›´æ—¶åŒæ­¥åˆ°å…¶ä»–æ ‡ç­¾é¡µ
useBroadcast('auth', (data) => {
  if (data.type === 'logout') {
    // æ¸…ç†æœ¬åœ°çŠ¶æ€
  }
});
```

### 7. çŠ¶æ€ä¸æƒé™æ§åˆ¶

```tsx
// components/ProtectedButton.tsx
import { useSelector } from 'react-redux';
export default function ProtectedButton({ role, ...props }) {
  const userRole = useSelector((s) => s.user.role);
  if (userRole !== role) return null;
  return <button {...props} />;
}
```

### 8. çŠ¶æ€ä¸å›½é™…åŒ–/å¤šç§Ÿæˆ·

```ts
// stores/i18n.ts
import create from 'zustand';
export const useI18nStore = create((set) => ({
  lang: 'zh',
  setLang: (lang) => set({ lang }),
}));

// åˆ‡æ¢è¯­è¨€
useI18nStore.getState().setLang('en');
```

### 9. çŠ¶æ€ä¸WebSocketå®æ—¶åä½œ

```ts
// hooks/useWebSocket.ts
import { useEffect } from 'react';
export function useWebSocket(url, onMessage) {
  useEffect(() => {
    const ws = new WebSocket(url);
    ws.onmessage = (e) => onMessage(JSON.parse(e.data));
    return () => ws.close();
  }, [url, onMessage]);
}

// åœ¨é€šçŸ¥ä¸­å¿ƒä¸­å®æ—¶æ¨é€æ–°æ¶ˆæ¯
useWebSocket('wss://api/ws', (msg) => useNotificationStore.getState().add(msg));
```

### 10. çŠ¶æ€ä¸ç¼“å­˜å¤±æ•ˆ/æ‰‹åŠ¨åˆ·æ–°

```tsx
// components/RefreshButton.tsx
import { mutate } from 'swr';
export default function RefreshButton() {
  return <button onClick={() => mutate('/api/user')}>æ‰‹åŠ¨åˆ·æ–°ç”¨æˆ·æ•°æ®</button>;
}
```

### 11. çŠ¶æ€ä¸ç°åº¦å‘å¸ƒ/ABæµ‹è¯•

```ts
// stores/experiment.ts
import create from 'zustand';
export const useExperimentStore = create(() => ({
  group: Math.random() > 0.5 ? 'A' : 'B',
}));

// ç»„ä»¶å†…æŒ‰åˆ†ç»„æ¸²æŸ“
const group = useExperimentStore((s) => s.group);
return group === 'A' ? <NewUI /> : <OldUI />;
```

### 12. çŠ¶æ€è‡ªåŠ¨åŒ–æµ‹è¯•

```js
// __tests__/themeStore.test.ts
import { act } from 'react-dom/test-utils';
import { useThemeStore } from '../stores/theme';

test('ä¸»é¢˜åˆ‡æ¢', () => {
  act(() => {
    useThemeStore.getState().toggle();
  });
  expect(useThemeStore.getState().mode).toBe('dark');
});
```

---

## ä¼ä¸šçº§å®æˆ˜æ¡ˆä¾‹ï¼ˆæ‰©å±•ï¼‰

### 1. å¤šæ ‡ç­¾åŒæ­¥é€šçŸ¥ä¸­å¿ƒ
- ç”¨æˆ·åœ¨ä»»ä¸€æ ‡ç­¾é¡µæ“ä½œï¼ˆå¦‚ç™»å‡ºã€æ¶ˆæ¯å·²è¯»ï¼‰ï¼Œæ‰€æœ‰æ ‡ç­¾é¡µè‡ªåŠ¨åŒæ­¥ã€‚
- BroadcastChannel/Service Worker å®ç°å…¨å±€çŠ¶æ€åŒæ­¥ã€‚

### 2. æƒé™åˆ†çº§çš„å…¨å±€çŠ¶æ€ç®¡ç†
- ä¸åŒè§’è‰²/ç§Ÿæˆ·æ‹¥æœ‰ä¸åŒèœå•ã€æŒ‰é’®ã€æ•°æ®æƒé™ã€‚
- å…¨å±€çŠ¶æ€å­˜å‚¨æƒé™ï¼Œç»„ä»¶/è·¯ç”±æŒ‰æƒé™æ¸²æŸ“ã€‚

### 3. å›½é™…åŒ–ä¸å¤šç§Ÿæˆ·çŠ¶æ€ç®¡ç†
- å…¨å±€çŠ¶æ€å­˜å‚¨å½“å‰è¯­è¨€ã€ç§Ÿæˆ·IDï¼Œæ”¯æŒå¤šè¯­è¨€/å¤šç§Ÿæˆ·åˆ‡æ¢ã€‚
- çŠ¶æ€ä¸åç«¯åä½œï¼Œåˆ‡æ¢æ—¶è‡ªåŠ¨åˆ·æ–°æ•°æ®ã€‚

### 4. çŠ¶æ€ä¸Serverless/å¾®æœåŠ¡é›†æˆ
- çŠ¶æ€å˜æ›´åè‡ªåŠ¨æ¨é€åˆ°å¾®æœåŠ¡/Serverlessï¼Œæ”¯æŒå®æ—¶é€šçŸ¥ã€å…¨å±€åˆ·æ–°ã€‚

### 5. çŠ¶æ€ä¸ç°åº¦å‘å¸ƒ/ABæµ‹è¯•
- å…¨å±€çŠ¶æ€å­˜å‚¨å®éªŒåˆ†ç»„ï¼ŒæŒ‰åˆ†ç»„æ¸²æŸ“ä¸åŒUI/åŠŸèƒ½ï¼Œæ”¯æŒåŠ¨æ€åˆ‡æ¢ã€‚

---

## æœ€ä½³å®è·µï¼ˆæ‰©å±•ï¼‰
- **å®‰å…¨**ï¼šToken/æ•æ„Ÿä¿¡æ¯ä»…å­˜å†…å­˜æˆ– HttpOnly Cookieï¼ŒçŠ¶æ€å˜æ›´éœ€é‰´æƒã€‚
- **æ€§èƒ½**ï¼šå¤šæ ‡ç­¾åŒæ­¥ç”¨ BroadcastChannelï¼ŒWebSocket/SSE å®æ—¶æ¨é€ï¼Œç¼“å­˜å¤±æ•ˆåŠæ—¶åˆ·æ–°ã€‚
- **åä½œ**ï¼šç»Ÿä¸€çŠ¶æ€ç®¡ç†æ–¹æ¡ˆã€ç›®å½•ç»“æ„ã€å‘½åè§„èŒƒï¼Œå…³é”®çŠ¶æ€æµç¨‹è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚
- **ç›‘æ§**ï¼šçŠ¶æ€å¼‚å¸¸ã€åŒæ­¥å¤±è´¥ã€æƒé™è¶Šæƒç­‰æ—¥å¿—é‡‡é›†ä¸å‘Šè­¦ã€‚
- **åˆè§„**ï¼šå¤šç§Ÿæˆ·/å›½é™…åŒ–çŠ¶æ€éš”ç¦»ï¼Œæ•æ„Ÿä¿¡æ¯åŠ å¯†ï¼Œç¬¦åˆGDPR/ç­‰ä¿ã€‚

---

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆï¼ˆæ‰©å±•ï¼‰

### Q6: å¤šæ ‡ç­¾/å¤šçª—å£çŠ¶æ€å¦‚ä½•åŒæ­¥ï¼Ÿ
A: ç”¨ BroadcastChannelã€localStorage äº‹ä»¶ã€Service Worker å®ç°ï¼Œå…³é”®çŠ¶æ€å˜æ›´æ—¶å¹¿æ’­æ¶ˆæ¯ã€‚

### Q7: å¦‚ä½•é˜²æ­¢çŠ¶æ€æ³„éœ²ä¸æƒé™è¶Šæƒï¼Ÿ
A: Token/æ•æ„Ÿä¿¡æ¯ä»…å­˜å†…å­˜/HttpOnly Cookieï¼Œç»„ä»¶/è·¯ç”±æŒ‰æƒé™æ¸²æŸ“ï¼Œåç«¯äºŒæ¬¡æ ¡éªŒã€‚

### Q8: çŠ¶æ€ä¸å›½é™…åŒ–/å¤šç§Ÿæˆ·å¦‚ä½•åä½œï¼Ÿ
A: å…¨å±€çŠ¶æ€å­˜å‚¨å½“å‰è¯­è¨€/ç§Ÿæˆ·IDï¼Œåˆ‡æ¢æ—¶è‡ªåŠ¨åˆ·æ–°æ•°æ®ï¼Œåç«¯æ¥å£æ”¯æŒå¤šè¯­è¨€/å¤šç§Ÿæˆ·ã€‚

### Q9: çŠ¶æ€ä¸WebSocket/å®æ—¶æ¨é€å¦‚ä½•é›†æˆï¼Ÿ
A: å…¨å±€çŠ¶æ€ä¸ WebSocket/SSE/GraphQL è®¢é˜…åä½œï¼Œæ¨é€æ–°æ•°æ®è‡ªåŠ¨æ›´æ–° Storeã€‚

### Q10: çŠ¶æ€ä¸ç°åº¦å‘å¸ƒ/ABæµ‹è¯•å¦‚ä½•è½åœ°ï¼Ÿ
A: å…¨å±€çŠ¶æ€å­˜å‚¨å®éªŒåˆ†ç»„ï¼ŒæŒ‰åˆ†ç»„æ¸²æŸ“ä¸åŒUI/åŠŸèƒ½ï¼Œæ”¯æŒåŠ¨æ€åˆ‡æ¢ä¸æ•°æ®åˆ†æã€‚

---

## é…å›¾è¯´æ˜ï¼ˆæ‰©å±•ï¼‰

```mermaid
graph TD;
  A[åç«¯/Server Actions] --> B[å…¨å±€çŠ¶æ€ Store]
  B --> C[ç»„ä»¶è®¢é˜…æ¸²æŸ“]
  B --> D[æœ¬åœ°æŒä¹…åŒ–/å¤šæ ‡ç­¾åŒæ­¥]
  C --> E[ç”¨æˆ·æ“ä½œ]
  E --> B
  B --> F[æƒé™/å›½é™…åŒ–/å¤šç§Ÿæˆ·åˆ†æµ]
  B --> G[WebSocket/å®æ—¶æ¨é€]
  B --> H[ç°åº¦å‘å¸ƒ/ABæµ‹è¯•åˆ†ç»„]
```

> Next.js çŠ¶æ€ç®¡ç†å¤šæ ‡ç­¾åŒæ­¥ã€æƒé™åˆ†çº§ã€å›½é™…åŒ–ã€ç°åº¦å‘å¸ƒã€å®æ—¶æ¨é€ç­‰å…¨æµç¨‹ç¤ºæ„å›¾ã€‚

> æœ€åæ„Ÿè°¢é˜…è¯»ï¼æ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼ï¼
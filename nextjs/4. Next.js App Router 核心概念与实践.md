# å‰è¨€
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é²«å°é±¼ã€‚æ˜¯ä¸€å`ä¸å†™å‰ç«¯ä»£ç `çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçƒ­è¡·äºåˆ†äº«éå‰ç«¯çš„çŸ¥è¯†ï¼Œå¸¦é¢†åˆ‡å›¾ä»”é€ƒç¦»åˆ‡å›¾åœˆå­ï¼Œæ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼

# ç¬¬å››ç« ï¼šNext.js App Router æ ¸å¿ƒæ¦‚å¿µä¸å®è·µ

## æ•™ç¨‹ç®€ä»‹

æ¬¢è¿æ¥åˆ° Next.js æ¼”è¿›ä¸­æœ€æ¿€åŠ¨äººå¿ƒçš„éƒ¨åˆ†â€”â€”App Routerã€‚ä½œä¸º Next.js 13+ çš„æ ¸å¿ƒç‰¹æ€§ï¼ŒApp Router å»ºç«‹åœ¨ React Server Components (RSC) çš„åŸºç¡€ä¸Šï¼Œå½»åº•æ”¹å˜äº†æˆ‘ä»¬æ„å»ºå…¨æ ˆåº”ç”¨çš„æ–¹å¼ã€‚å®ƒä¸ä»…æä¾›äº†æ›´çµæ´»ã€æ›´å¼ºå¤§çš„è·¯ç”±å’Œå¸ƒå±€ç³»ç»Ÿï¼Œè¿˜é€šè¿‡é»˜è®¤çš„æœåŠ¡ç«¯ç»„ä»¶èŒƒå¼ï¼Œå¸¦æ¥äº†æ˜¾è‘—çš„æ€§èƒ½æå‡ã€‚

åœ¨æœ¬ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ App Router çš„å¼•å…¥ç›®çš„ã€ä¸ Pages Router çš„æ ¸å¿ƒå·®å¼‚ï¼Œå¹¶è¯¦ç»†è§£æå…¶åŸºäºç›®å½•çš„çº¦å®šï¼Œç‰¹åˆ«æ˜¯ `layout.tsx`, `page.tsx`, `loading.tsx`, `error.tsx` ç­‰ç‰¹æ®Šæ–‡ä»¶çš„ä½œç”¨ã€‚æˆ‘ä»¬è¿˜å°†ç»“åˆä¼ä¸šçº§å¼€å‘ã€ç§»åŠ¨ç«¯é€‚é…ã€SEOã€æƒé™æ§åˆ¶ã€å…¨æ ˆå¼€å‘ç­‰å®é™…åœºæ™¯ï¼Œåˆ†äº«æœ€ä½³å®è·µå’Œå¸¸è§é—®é¢˜è§£å†³æ–¹æ¡ˆã€‚é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæ‚¨å°†æŒæ¡ App Router çš„æ ¸å¿ƒæ€æƒ³ï¼Œå¹¶èƒ½å¤Ÿåˆ©ç”¨å®ƒæ¥æ„å»ºç°ä»£åŒ–ã€é«˜æ€§èƒ½çš„ Next.js åº”ç”¨ã€‚

## ç†è®ºè®²è§£

### 1.1 App Router çš„å¼•å…¥ç›®çš„ä¸ Pages Router å¯¹æ¯”

App Router çš„è¯ç”Ÿæ˜¯ä¸ºäº†è§£å†³ Pages Router åœ¨å¤æ‚åº”ç”¨åœºæ™¯ä¸‹é¢ä¸´çš„ä¸€äº›æŒ‘æˆ˜ï¼Œå¹¶å……åˆ†åˆ©ç”¨ React æœ€æ–°çš„ç‰¹æ€§ï¼ˆå¦‚ Server Components å’Œ Suspenseï¼‰ã€‚

**æ ¸å¿ƒå·®å¼‚å¯¹æ¯”ï¼š**

| ç‰¹æ€§                 | Pages Router (`pages/`)                                | App Router (`app/`)                                                              |
| -------------------- | ------------------------------------------------------ | -------------------------------------------------------------------------------- |
| **åŸºç¡€èŒƒå¼**         | å®¢æˆ·ç«¯ç»„ä»¶ (Client Components) ä¸ºä¸»                     | æœåŠ¡ç«¯ç»„ä»¶ (Server Components) ä¸ºä¸»ï¼ŒæŒ‰éœ€ä½¿ç”¨å®¢æˆ·ç«¯ç»„ä»¶                          |
| **è·¯ç”±å®šä¹‰**         | åŸºäºæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶æ˜¯ä¸€ä¸ªè·¯ç”±                             | åŸºäºç›®å½•ï¼Œæ¯ä¸ªç›®å½•æ˜¯ä¸€ä¸ªè·¯ç”±æ®µï¼Œ`page.tsx` ä½œä¸ºè¯¥è·¯ç”±çš„ UI                       |
| **å¸ƒå±€**             | é€šè¿‡ `_app.tsx` å’Œè‡ªå®šä¹‰ç»„ä»¶å®ç°ï¼Œè¾ƒä¸ºå—é™             | å†…ç½®å±‚çº§å¸ƒå±€ç³»ç»Ÿ (`layout.tsx`)ï¼Œæ”¯æŒåµŒå¥—å¸ƒå±€å’ŒçŠ¶æ€ä¿æŒ                        |
| **æ•°æ®è·å–**         | `getServerSideProps`, `getStaticProps` ç­‰ä¸“ç”¨ API        | ç›´æ¥åœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­ä½¿ç”¨ `async/await`ï¼Œä¸ `fetch` API æ·±åº¦é›†æˆï¼Œæ›´çµæ´»          |
| **åŠ è½½/é”™è¯¯ UI**     | éœ€è¦æ‰‹åŠ¨å®ç°                                           | å†…ç½® `loading.tsx` å’Œ `error.tsx`ï¼Œåˆ©ç”¨ React Suspense å’Œ Error Boundaries è‡ªåŠ¨å¤„ç† |
| **å…¨æ ˆèƒ½åŠ›**         | API Routes (`pages/api`)                               | API Routes ä¾ç„¶æ”¯æŒï¼Œå¹¶æ–°å¢ Server Actions ç”¨äºåœ¨ç»„ä»¶ä¸­ç›´æ¥è°ƒç”¨æœåŠ¡ç«¯é€»è¾‘        |
| **SEO**              | éœ€æ‰‹åŠ¨é…ç½® metaã€head                                  | `generateMetadata`ã€`<Head />` ç»„ä»¶ï¼Œæ”¯æŒåˆ†å±‚ SEOã€Open Graphã€ç§»åŠ¨ç«¯é€‚é…        |
| **æƒé™æ§åˆ¶**         | éœ€æ‰‹åŠ¨åœ¨é¡µé¢æˆ– `_app.tsx` å¤„ç†                         | å¯åœ¨ layoutã€middlewareã€Server Actions ç­‰å¤šå±‚çµæ´»å¤„ç†                          |

### 1.2 ç›®å½•çº¦å®šä¸æœ€ä½³å®è·µ

App Router é€šè¿‡ä¸€ç³»åˆ—ç‰¹æ®Šæ–‡ä»¶æ¥å®šä¹‰è·¯ç”±çš„è¡Œä¸ºå’Œ UIã€‚

*   **`page.tsx`**: å®šä¹‰è·¯ç”±çš„å”¯ä¸€ UIã€‚ä¾‹å¦‚ï¼Œ`app/dashboard/page.tsx` ä¼šæ¸²æŸ“ `/dashboard` è·¯å¾„ã€‚
*   **`layout.tsx`**: å®šä¹‰è·¨å¤šä¸ªé¡µé¢å…±äº«çš„ UIã€‚ä¸€ä¸ª `layout` ä¼šåŒ…è£¹å…¶å­ç›®å½•ä¸­çš„æ‰€æœ‰é¡µé¢å’Œå­å¸ƒå±€ã€‚å¸ƒå±€æ˜¯å±‚çº§åµŒå¥—çš„ï¼Œå¹¶ä¸”åœ¨å¯¼èˆªæ—¶ä¿æŒçŠ¶æ€ã€‚
*   **`loading.tsx`**: ä¸€ä¸ªåŠ è½½çŠ¶æ€ UIï¼Œå®ƒä¼šåˆ©ç”¨ React Suspense è‡ªåŠ¨åŒ…è£¹ `page.tsx`ã€‚å½“é¡µé¢å†…å®¹æ­£åœ¨åŠ è½½æ—¶ï¼ŒNext.js ä¼šè‡ªåŠ¨æ˜¾ç¤º `loading.tsx` çš„å†…å®¹ï¼Œæä¾›å³æ—¶çš„åŠ è½½åé¦ˆã€‚
*   **`error.tsx`**: ä¸€ä¸ªé”™è¯¯å¤„ç† UIï¼Œå®ƒä¼šåˆ©ç”¨ React Error Boundary è‡ªåŠ¨åŒ…è£¹ `page.tsx`ã€‚å½“é¡µé¢æˆ–å…¶å­ç»„ä»¶æŠ›å‡ºé”™è¯¯æ—¶ï¼Œä¼šæ˜¾ç¤º `error.tsx` çš„å†…å®¹ï¼Œå¹¶æä¾›ä¸€ä¸ªå‡½æ•°æ¥å°è¯•é‡æ–°æ¸²æŸ“ã€‚
*   **`not-found.tsx`**: å½“ `notFound()` å‡½æ•°è¢«è°ƒç”¨æˆ– URL ä¸åŒ¹é…ä»»ä½•è·¯ç”±æ—¶ï¼Œä¼šæ˜¾ç¤ºæ­¤ UIã€‚
*   **`template.tsx`**: ä¸ `layout.tsx` ç±»ä¼¼ï¼Œä½†å®ƒåœ¨æ¯æ¬¡å¯¼èˆªæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼ŒçŠ¶æ€ä¸ä¼šè¢«ä¿ç•™ã€‚é€‚ç”¨äºéœ€è¦æ¯æ¬¡è¿›å…¥éƒ½æ‰§è¡Œ `useEffect` æˆ–é‡æ–°è·å–æ•°æ®çš„åœºæ™¯ã€‚

**æœ€ä½³å®è·µï¼š**
- å……åˆ†åˆ©ç”¨åµŒå¥—å¸ƒå±€ï¼Œå°†å…¨å±€å¯¼èˆªã€ä¾§è¾¹æ ã€ç”¨æˆ·ä¿¡æ¯ç­‰æ”¾åœ¨ä¸åŒå±‚çº§çš„ layout ä¸­ï¼Œæå‡å¤ç”¨æ€§å’Œæ€§èƒ½ã€‚
- ä½¿ç”¨ `loading.tsx` æå‡ç”¨æˆ·ä½“éªŒï¼Œé¿å…é¡µé¢ç™½å±ã€‚
- åœ¨ `error.tsx` ä¸­é›†æˆé”™è¯¯ä¸ŠæŠ¥ï¼ˆå¦‚ Sentryï¼‰ï¼Œå¹¶ä¸ºç”¨æˆ·æä¾›é‡è¯•æŒ‰é’®ã€‚
- åˆç†æ‹†åˆ†æœåŠ¡ç«¯ç»„ä»¶å’Œå®¢æˆ·ç«¯ç»„ä»¶ï¼Œå‡å°‘ bundle ä½“ç§¯ã€‚
- ä½¿ç”¨ `generateMetadata` åŠ¨æ€ç”Ÿæˆ SEO ä¿¡æ¯ï¼Œæ”¯æŒå¤šè¯­è¨€å’Œç§»åŠ¨ç«¯é€‚é…ã€‚

### 1.3 æœåŠ¡ç«¯ç»„ä»¶ (RSC) ä¸å®¢æˆ·ç«¯ç»„ä»¶çš„åä½œ

App Router æœ€å¤§çš„åˆ›æ–°åœ¨äº Server Componentsã€‚æœåŠ¡ç«¯ç»„ä»¶å¯ä»¥ç›´æ¥è®¿é—®æ•°æ®åº“ã€APIã€æ–‡ä»¶ç³»ç»Ÿç­‰åç«¯èµ„æºï¼Œæå¤§æå‡äº†æ•°æ®è·å–çš„çµæ´»æ€§å’Œå®‰å…¨æ€§ã€‚

**å¸¸è§åä½œæ¨¡å¼ï¼š**
- æœåŠ¡ç«¯ç»„ä»¶è´Ÿè´£æ•°æ®è·å–å’Œé¡µé¢éª¨æ¶æ¸²æŸ“ï¼Œå®¢æˆ·ç«¯ç»„ä»¶è´Ÿè´£äº¤äº’å’ŒåŠ¨ç”»ã€‚
- é€šè¿‡ props å°†æœåŠ¡ç«¯è·å–çš„æ•°æ®ä¼ é€’ç»™å®¢æˆ·ç«¯ç»„ä»¶ã€‚
- å®¢æˆ·ç«¯ç»„ä»¶å¯é€šè¿‡ Server Actions ç›´æ¥è°ƒç”¨æœåŠ¡ç«¯é€»è¾‘ï¼Œå®ç°æ—  API å±‚çš„å…¨æ ˆå¼€å‘ä½“éªŒã€‚

**æ³¨æ„äº‹é¡¹ï¼š**
- å®¢æˆ·ç«¯ç»„ä»¶ä¸èƒ½ç›´æ¥è®¿é—®æœåŠ¡ç«¯èµ„æºã€‚
- æœåŠ¡ç«¯ç»„ä»¶ä¸èƒ½ä½¿ç”¨ React çš„æµè§ˆå™¨ Hooksï¼ˆå¦‚ useStateã€useEffectï¼‰ã€‚
- ç»„ä»¶æ ‘ä¸­åªè¦æœ‰ä¸€ä¸ªå®¢æˆ·ç«¯ç»„ä»¶ï¼Œå…¶æ‰€æœ‰å­ç»„ä»¶éƒ½å°†è¢«æ‰“åŒ…åˆ°å®¢æˆ·ç«¯ã€‚

### 1.4 è·¯ç”±å®šä¹‰ã€åµŒå¥—å¸ƒå±€ä¸åˆ†ç»„

App Router æ”¯æŒè·¯ç”±åˆ†ç»„ï¼ˆGroupï¼‰ã€å¹¶è¡Œè·¯ç”±ï¼ˆParallel Routesï¼‰ã€æ‹¦æˆªè·¯ç”±ï¼ˆIntercepting Routesï¼‰ç­‰é«˜çº§ç‰¹æ€§ã€‚

- **è·¯ç”±åˆ†ç»„**ï¼šé€šè¿‡ `(group)` ç›®å½•å®ç° URL ä¸å˜ä½†ç»“æ„åˆ†ç»„ï¼Œä¾¿äºä»£ç ç»„ç»‡ã€‚
- **å¹¶è¡Œè·¯ç”±**ï¼šé€šè¿‡ `@slot` ç›®å½•å®ç°åŒä¸€é¡µé¢å¤šä¸ªåŒºåŸŸç‹¬ç«‹æ¸²æŸ“ï¼Œé€‚åˆå¤šæ ‡ç­¾é¡µã€å¼¹çª—ç­‰åœºæ™¯ã€‚
- **æ‹¦æˆªè·¯ç”±**ï¼šé€šè¿‡ `(..)(route)` ç›®å½•å®ç°å¼¹çª—ã€ä¾§è¾¹æ ç­‰ UI å±‚çº§çš„è·¯ç”±åˆ‡æ¢ã€‚

**ç¤ºä¾‹ç»“æ„ï¼š**
```
app/
  dashboard/
    layout.tsx
    page.tsx
    (settings)/
      page.tsx
    (profile)/
      page.tsx
  (auth)/
    login/page.tsx
    register/page.tsx
```

### 1.5 SEOã€ç§»åŠ¨ç«¯é€‚é…ä¸æ€§èƒ½ä¼˜åŒ–

- **SEO**ï¼šåˆ©ç”¨ `generateMetadata`ã€`<Head />` ç»„ä»¶ä¸ºæ¯ä¸ªé¡µé¢åŠ¨æ€ç”Ÿæˆ titleã€descriptionã€Open Graphã€Twitter Card ç­‰ meta æ ‡ç­¾ã€‚
- **ç§»åŠ¨ç«¯é€‚é…**ï¼šåœ¨ `layout.tsx` çš„ `<head>` ä¸­æ·»åŠ  viewportã€theme-color ç­‰ meta æ ‡ç­¾ï¼Œç»“åˆ Tailwind CSS æˆ– CSS Modules å®ç°å“åº”å¼å¸ƒå±€ã€‚
- **æ€§èƒ½ä¼˜åŒ–**ï¼š
  - åˆ©ç”¨æœåŠ¡ç«¯ç»„ä»¶å‡å°‘å®¢æˆ·ç«¯ bundle ä½“ç§¯ã€‚
  - ä½¿ç”¨ Suspense å’Œ `loading.tsx` ä¼˜åŒ–åŠ è½½ä½“éªŒã€‚
  - åˆ©ç”¨ `next/image`ã€`next/font` è¿›è¡Œå›¾ç‰‡å’Œå­—ä½“ä¼˜åŒ–ã€‚
  - åˆç†æ‹†åˆ†å¹¶è¡Œè·¯ç”±ï¼Œæå‡é¡µé¢å“åº”é€Ÿåº¦ã€‚

### 1.6 æƒé™æ§åˆ¶ä¸ä¼ä¸šçº§åœºæ™¯

- **æƒé™æ§åˆ¶**ï¼šå¯åœ¨ layoutã€middlewareã€Server Actions ç­‰å¤šå±‚å®ç°ã€‚
  - åœ¨ layout.tsx ä¸­åˆ¤æ–­ç”¨æˆ·æƒé™ï¼Œæœªç™»å½•æ—¶é‡å®šå‘åˆ°ç™»å½•é¡µã€‚
  - åœ¨ Server Actions ä¸­æ ¡éªŒç”¨æˆ·èº«ä»½ï¼Œé˜²æ­¢æœªæˆæƒæ“ä½œã€‚
  - ä½¿ç”¨ä¸­é—´ä»¶ï¼ˆ`middleware.ts`ï¼‰å®ç°å…¨å±€è·¯ç”±å®ˆå«ã€‚
- **ä¼ä¸šçº§åœºæ™¯**ï¼š
  - å¤šç§Ÿæˆ·ç³»ç»Ÿï¼šé€šè¿‡ layout åˆ†å±‚å®ç°ç§Ÿæˆ·éš”ç¦»ã€‚
  - å¤§å‹ä»ªè¡¨ç›˜ï¼šåˆ©ç”¨å¹¶è¡Œè·¯ç”±å’ŒåµŒå¥—å¸ƒå±€å®ç°å¤æ‚ UIã€‚
  - å›½é™…åŒ–ï¼šç»“åˆ `generateMetadata` å’Œå¤šè¯­è¨€è·¯ç”±ï¼Œæ”¯æŒå¤šè¯­è¨€ SEOã€‚

### 1.7 App Router ä¸å…¨æ ˆå¼€å‘

- **API Routes**ï¼š`app/api/` ç›®å½•ä¸‹å¯ç»§ç»­ä½¿ç”¨ API Routesï¼Œå¤„ç† RESTful æˆ– GraphQL è¯·æ±‚ã€‚
- **Server Actions**ï¼šåœ¨æœåŠ¡ç«¯ç»„ä»¶æˆ–å®¢æˆ·ç«¯ç»„ä»¶ä¸­ç›´æ¥å®šä¹‰ `async function`ï¼Œé€šè¿‡è¡¨å•æˆ–æŒ‰é’®è§¦å‘ï¼Œç®€åŒ–æ•°æ®å˜æ›´å’Œè¡¨å•æäº¤ã€‚
- **æ•°æ®åº“é›†æˆ**ï¼šæœåŠ¡ç«¯ç»„ä»¶å¯ç›´æ¥è®¿é—®æ•°æ®åº“ï¼ˆå¦‚ Prismaã€Drizzleã€TypeORMï¼‰ï¼Œæ— éœ€é¢å¤– API å±‚ã€‚
- **æ–‡ä»¶ä¸Šä¼ **ï¼šé€šè¿‡ Server Actions æˆ– API Routes å®ç°å®‰å…¨çš„æ–‡ä»¶ä¸Šä¼ ã€‚

### 1.8 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

- **é¡µé¢é—ªçƒ/ç™½å±**ï¼šç¡®ä¿ `loading.tsx` å­˜åœ¨å¹¶ä¼˜åŒ–éª¨æ¶å±ã€‚
- **å®¢æˆ·ç«¯ç»„ä»¶ bundle è¿‡å¤§**ï¼šåˆç†æ‹†åˆ†ç»„ä»¶ï¼Œé¿å…æœåŠ¡ç«¯ç»„ä»¶ä¸­åµŒå¥—è¿‡å¤šå®¢æˆ·ç«¯ç»„ä»¶ã€‚
- **SEO ä¸ç”Ÿæ•ˆ**ï¼šæ£€æŸ¥ `generateMetadata` æ˜¯å¦æ­£ç¡®å®ç°ï¼Œç¡®ä¿ meta æ ‡ç­¾åŠ¨æ€ç”Ÿæˆã€‚
- **æƒé™ç»•è¿‡**ï¼šæ‰€æœ‰æ•æ„Ÿæ“ä½œåŠ¡å¿…åœ¨æœåŠ¡ç«¯æ ¡éªŒæƒé™ã€‚
- **ç§»åŠ¨ç«¯é€‚é…é—®é¢˜**ï¼šä½¿ç”¨å“åº”å¼ CSSï¼Œæµ‹è¯•ä¸»æµè®¾å¤‡å…¼å®¹æ€§ã€‚

## ä»£ç ç¤ºä¾‹

### 2.1 åˆ›å»ºä¸€ä¸ªå¸¦æœ‰å…¨å±€å¸ƒå±€çš„ä»ªè¡¨ç›˜åº”ç”¨

æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª `/dashboard` è·¯ç”±ï¼Œå®ƒæœ‰è‡ªå·±çš„å¸ƒå±€ï¼Œç‹¬ç«‹äºåº”ç”¨çš„æ ¹å¸ƒå±€ã€‚

1.  **åˆ›å»ºæ ¹å¸ƒå±€ (`app/layout.tsx`)**ï¼š
    ```typescript
    // app/layout.tsx
    import type { Metadata } from 'next';
    import './globals.css'; // å‡è®¾æœ‰å…¨å±€æ ·å¼

    export const metadata: Metadata = {
      title: 'Next.js æ•™ç¨‹åº”ç”¨',
      description: 'ç”±é²«å°é±¼åˆ›å»º',
    };

    export default function RootLayout({ children }: { children: React.ReactNode }) {
      return (
        <html lang="en">
          <body>
            <header style={{ padding: '1rem', borderBottom: '1px solid #ccc' }}>
              <h1>æˆ‘çš„åº”ç”¨</h1>
            </header>
            <main>{children}</main>
          </body>
        </html>
      );
    }
    ```

2.  **åˆ›å»ºä»ªè¡¨ç›˜å¸ƒå±€ (`app/dashboard/layout.tsx`)**ï¼š
    ```typescript
    // app/dashboard/layout.tsx
    import Link from 'next/link';

    export default function DashboardLayout({ children }: { children: React.ReactNode }) {
      return (
        <section style={{ display: 'flex' }}>
          <nav style={{ width: '200px', borderRight: '1px solid #ccc', padding: '1rem' }}>
            <h2>ä»ªè¡¨ç›˜</h2>
            <ul>
              <li><Link href="/dashboard">ä¸»é¡µ</Link></li>
              <li><Link href="/dashboard/settings">è®¾ç½®</Link></li>
            </ul>
          </nav>
          <div style={{ flex: 1, padding: '1rem' }}>
            {children}
          </div>
        </section>
      );
    }
    ```

3.  **åˆ›å»ºä»ªè¡¨ç›˜é¡µé¢ (`app/dashboard/page.tsx`)**ï¼š
    ```typescript
    // app/dashboard/page.tsx
    export default function DashboardPage() {
      return <div>æ¬¢è¿æ¥åˆ°ä»ªè¡¨ç›˜ï¼</div>;
    }
    ```

4.  **åˆ›å»ºè®¾ç½®é¡µé¢ (`app/dashboard/settings/page.tsx`)**ï¼š
    ```typescript
    // app/dashboard/settings/page.tsx
    export default function SettingsPage() {
      return <div>è¿™é‡Œæ˜¯è®¾ç½®é¡µé¢ã€‚</div>;
    }
    ```

ç°åœ¨è®¿é—® `/dashboard` æˆ– `/dashboard/settings`ï¼Œä½ ä¼šçœ‹åˆ°å®ƒä»¬éƒ½è¢«ä»ªè¡¨ç›˜çš„ä¾§è¾¹æ å¸ƒå±€åŒ…è£¹ï¼Œå¹¶ä¸”æ•´ä¸ªåº”ç”¨åˆæœ‰å…¨å±€çš„ `RootLayout`ã€‚

### 2.2 æ¼”ç¤º `loading.js` å’Œ `error.js` çš„ä½¿ç”¨

1.  **åˆ›å»ºåŠ è½½çŠ¶æ€ UI (`app/dashboard/loading.tsx`)**ï¼š
    ```typescript
    // app/dashboard/loading.tsx
    export default function Loading() {
      // ä½ å¯ä»¥ä½¿ç”¨ä»»ä½• UI åº“çš„éª¨æ¶å±
      return <h2>ğŸŒ€ åŠ è½½ä¸­...</h2>;
    }
    ```

2.  **åœ¨è®¾ç½®é¡µé¢æ¨¡æ‹Ÿæ•°æ®åŠ è½½å»¶è¿Ÿ**ï¼š
    ```typescript
    // app/dashboard/settings/page.tsx (ä¿®æ”¹å)
    // æ¨¡æ‹Ÿæ•°æ®è·å–
    async function getData() {
      await new Promise((resolve) => setTimeout(resolve, 2000)); // æ¨¡æ‹Ÿ2ç§’å»¶è¿Ÿ
      return { theme: 'dark' };
    }

    export default async function SettingsPage() {
      const data = await getData();
      return (
        <div>
          <h1>è®¾ç½®é¡µé¢</h1>
          <p>å½“å‰ä¸»é¢˜: {data.theme}</p>
        </div>
      );
    }
    ```
    ç°åœ¨ï¼Œå½“æ‚¨ä» `/dashboard` å¯¼èˆªåˆ° `/dashboard/settings` æ—¶ï¼Œä¼šç«‹å³çœ‹åˆ° "ğŸŒ€ åŠ è½½ä¸­..." çš„æç¤ºï¼Œ2ç§’åæ‰ä¼šæ˜¾ç¤ºé¡µé¢å†…å®¹ã€‚

3.  **åˆ›å»ºé”™è¯¯å¤„ç† UI (`app/dashboard/error.tsx`)**ï¼š
    ```typescript
    // app/dashboard/error.tsx
    'use client'; // é”™è¯¯ç»„ä»¶å¿…é¡»æ˜¯å®¢æˆ·ç«¯ç»„ä»¶

    import { useEffect } from 'react';

    export default function Error({
      error,
      reset,
    }: {
      error: Error & { digest?: string };
      reset: () => void;
    }) {
      useEffect(() => {
        // å¯ä»¥å°†é”™è¯¯ä¸ŠæŠ¥ç»™æ—¥å¿—æœåŠ¡
        console.error(error);
      }, [error]);

      return (
        <div>
          <h2>å‡ºé”™äº†ï¼</h2>
          <button onClick={() => reset()}>å†è¯•ä¸€æ¬¡</button>
        </div>
      );
    }
    ```

4.  **åœ¨é¡µé¢ä¸­æ•…æ„æŠ›å‡ºé”™è¯¯**ï¼š
    ```typescript
    // app/dashboard/settings/page.tsx (å†æ¬¡ä¿®æ”¹)
    export default async function SettingsPage() {
      // æ•…æ„æŠ›å‡ºé”™è¯¯ä»¥æµ‹è¯• error.tsx
      if (Math.random() > 0.5) {
        throw new Error('åŠ è½½è®¾ç½®å¤±è´¥ï¼');
      }
      return <div>è®¾ç½®é¡µé¢</div>;
    }
    ```
    ç°åœ¨åˆ·æ–° `/dashboard/settings` é¡µé¢ï¼Œæœ‰ 50% çš„å‡ ç‡ä¼šçœ‹åˆ° "å‡ºé”™äº†ï¼" çš„ç•Œé¢ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç‚¹å‡»æŒ‰é’®å°è¯•é‡æ–°æ¸²æŸ“ã€‚

## å®æˆ˜é¡¹ç›®

### 3.1 å°†ç°æœ‰ Pages Router çš„ä¸€éƒ¨åˆ†åŠŸèƒ½è¿ç§»åˆ° App Router

**ç›®æ ‡**ï¼šä½“éªŒæ–°æ—§è·¯ç”±çš„å·®å¼‚ä¸ä¼˜åŠ¿ï¼Œå°†ä¸€ä¸ªæ¨¡æ‹Ÿçš„ç”¨æˆ·åˆ—è¡¨åŠŸèƒ½ä» Pages Router çš„æ€ç»´æ¨¡å¼è½¬å˜ä¸º App Router çš„æ€ç»´æ¨¡å¼ã€‚

1.  **ç¡®å®šè¿ç§»åŠŸèƒ½**ï¼šæˆ‘ä»¬è¿ç§»ä¸€ä¸ªç”¨æˆ·åˆ—è¡¨é¡µé¢ `/users`ã€‚
2.  **åœ¨ `app` ç›®å½•ä¸‹åˆ›å»ºæ–°è·¯ç”±**ï¼š
    *   åˆ›å»º `app/users/page.tsx`ã€‚
    *   (å¯é€‰) åˆ›å»º `app/users/layout.tsx` å¦‚æœéœ€è¦ç‰¹å®šå¸ƒå±€ã€‚

3.  **æ•°æ®è·å–æ–¹å¼çš„è½¬å˜**ï¼š

    *   **æ—§æ–¹å¼ (Pages Router)**ï¼šä½ å¯èƒ½ä¼šåœ¨ `pages/users.tsx` ä¸­ä½¿ç”¨ `getStaticProps` æˆ– `getServerSideProps`ã€‚
        ```typescript
        // pages/users.tsx (æ—§æ–¹å¼)
        // export async function getStaticProps() { ... }
        ```
    *   **æ–°æ–¹å¼ (App Router)**ï¼šåœ¨ `app/users/page.tsx` (ä¸€ä¸ªæœåŠ¡ç«¯ç»„ä»¶) ä¸­ç›´æ¥ `fetch` æ•°æ®ã€‚

4.  **å®ç° `app/users/page.tsx`**ï¼š
    ```typescript
    // app/users/page.tsx

    interface User {
      id: number;
      name: string;
      email: string;
    }

    // åœ¨æœåŠ¡ç«¯ç»„ä»¶ä¸­ç›´æ¥è·å–æ•°æ®
    async function getUsers(): Promise<User[]> {
      // åœ¨çœŸå®åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ˜¯ fetch('https://api.example.com/users')
      // æˆ‘ä»¬ç”¨ä¸€ä¸ªæ¨¡æ‹Ÿçš„ API
      const res = await fetch('https://jsonplaceholder.typicode.com/users');
      if (!res.ok) {
        throw new Error('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥');
      }
      return res.json();
    }

    export default async function UsersPage() {
      const users = await getUsers();

      return (
        <div>
          <h1>ç”¨æˆ·åˆ—è¡¨</h1>
          <ul>
            {users.map((user) => (
              <li key={user.id}>
                {user.name} ({user.email})
              </li>
            ))}
          </ul>
        </div>
      );
    }
    ```

5.  **æ·»åŠ  `loading.tsx` å’Œ `error.tsx`**ï¼š
    *   åœ¨ `app/users/` ç›®å½•ä¸‹åˆ›å»º `loading.tsx` å’Œ `error.tsx`ï¼Œä»¥æä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚
    ```typescript
    // app/users/loading.tsx
    export default function Loading() {
      return <p>æ­£åœ¨åŠ è½½ç”¨æˆ·åˆ—è¡¨...</p>;
    }
    ```
    ```typescript
    // app/users/error.tsx
    'use client';
    export default function Error({ reset }: { reset: () => void }) {
      return (
        <div>
          <p>åŠ è½½ç”¨æˆ·åˆ—è¡¨å¤±è´¥ï¼</p>
          <button onClick={() => reset()}>é‡è¯•</button>
        </div>
      );
    }
    ```

**ä½“éªŒå·®å¼‚ä¸ä¼˜åŠ¿**ï¼š

*   **ä»£ç ç®€æ´**ï¼šæ•°æ®è·å–é€»è¾‘ä¸ UI æ›´ç´§å¯†åœ°ç»“åˆåœ¨ä¸€èµ·ï¼Œæ— éœ€å¯¼å‡ºä¸“é—¨çš„å‡½æ•°ã€‚
*   **é»˜è®¤æœåŠ¡ç«¯**ï¼šé»˜è®¤å°±æ˜¯é«˜æ€§èƒ½çš„æœåŠ¡ç«¯ç»„ä»¶ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚
*   **å†…ç½® UX ä¼˜åŒ–**ï¼š`loading` å’Œ `error` UI çš„å¤„ç†å˜å¾—éå¸¸ç®€å•å’Œè‡ªåŠ¨åŒ–ã€‚
*   **ç»„ä»¶åŒ–æ›´å½»åº•**ï¼šä½ å¯ä»¥å°†æ•°æ®è·å–é€»è¾‘å’Œ UI å°è£…åœ¨ä¸€ä¸ªç»„ä»¶å†…ï¼Œè€Œä¸æ˜¯åˆ†ç¦»åˆ°é¡µé¢çº§å‡½æ•°ä¸­ã€‚

é€šè¿‡æœ¬ç« çš„å­¦ä¹ ï¼Œæ‚¨å·²ç»æŒæ¡äº† Next.js App Router çš„æ ¸å¿ƒæ¦‚å¿µï¼ŒåŒ…æ‹¬å…¶ä¸ Pages Router çš„åŒºåˆ«ã€åŸºäºç›®å½•çš„ç‰¹æ®Šæ–‡ä»¶çº¦å®šã€æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯ç»„ä»¶çš„èŒƒå¼ï¼Œä»¥åŠå¦‚ä½•åˆ©ç”¨åµŒå¥—å¸ƒå±€å’Œå†…ç½®çš„åŠ è½½/é”™è¯¯å¤„ç†æœºåˆ¶æ¥æ„å»ºç°ä»£åŒ–çš„ Web åº”ç”¨ã€‚ä¸‹ä¸€ç« ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨ç»„ä»¶åŒ–çš„è®¾è®¡æ¨¡å¼å’Œé«˜çº§æ ·å¼ç®¡ç†ã€‚

> æœ€åæ„Ÿè°¢é˜…è¯»ï¼æ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼ï¼
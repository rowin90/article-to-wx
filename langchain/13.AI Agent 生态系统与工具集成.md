# ç¬¬13ç« ï¼šAI Agent ç”Ÿæ€ç³»ç»Ÿä¸å·¥å…·é›†æˆ

# å‰è¨€
å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯é²«å°é±¼ã€‚æ˜¯ä¸€å`ä¸å†™å‰ç«¯ä»£ç `çš„å‰ç«¯å·¥ç¨‹å¸ˆï¼Œçƒ­è¡·äºåˆ†äº«éå‰ç«¯çš„çŸ¥è¯†ï¼Œå¸¦é¢†åˆ‡å›¾ä»”é€ƒç¦»åˆ‡å›¾åœˆå­ï¼Œæ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼

## ğŸ¯ æœ¬ç« å­¦ä¹ ç›®æ ‡
- ä½“ç³»åŒ–æŒæ¡ Agent å·¥å…·ç”Ÿæ€æ¥å…¥ï¼šæœç´¢ã€æ—¥å†ã€é‚®ä»¶ã€å·¥å•ã€æ–‡æ¡£ã€æ•°æ®ä»“åº“ç­‰
- è®¾è®¡å®‰å…¨åˆè§„çš„å·¥å…·é€‚é…å±‚ï¼šé‰´æƒä¸å¯†é’¥ç®¡ç†ã€é™æµä¸é…é¢ã€å®¡è®¡ä¸å›æ”¾ã€æ²™ç®±æ‰§è¡Œ
- å»ºç«‹å¯æ‰©å±•çš„ Tool Registry ä¸åè®®ï¼šZod Schemaã€å¹‚ç­‰è®¾è®¡ã€è¶…æ—¶/é‡è¯•/ç†”æ–­
- ç”¨ LangGraph ç¼–æ’å¤šå·¥å…·ä¸å¤š Agent åä½œï¼šè®¡åˆ’â†’å¹¶è¡Œæ‰§è¡Œâ†’å½’å¹¶â†’å†²çªè§£å†³
- åœ¨ Next.js ä¸­å®ç° OAuth å›è°ƒã€å·¥å…·æˆæƒé¡µé¢ã€æ‰§è¡Œå¯è§†åŒ–æ—¶é—´çº¿
- å®æˆ˜é¡¹ç›®ï¼šä¼ä¸šååŒåŠ©æ‰‹ï¼ˆä¼šè®®å®‰æ’ + çºªè¦ç”Ÿæˆ + å·¥å•åˆ›å»º + é€šçŸ¥å‘é€ï¼‰

---

## ğŸ§© å·¥å…·é€‚é…å±‚è®¾è®¡ï¼ˆAdapter Patternï¼‰

### 13.1 è®¾è®¡åŸåˆ™
- æ ‡å‡†åŒ–ï¼šç»Ÿä¸€ `name/description/schema/_call` æ¥å£ï¼Œä¸ LangChain Tool å¯¹é½
- å®‰å…¨æ€§ï¼šæœ€å°æƒé™ï¼ˆOAuth scopeï¼‰ã€ç§Ÿæˆ·éš”ç¦»ã€é€Ÿç‡é™åˆ¶ã€å®¡è®¡ç•™ç—•
- ç¨³å®šæ€§ï¼šè¶…æ—¶/é‡è¯•/ç†”æ–­/é™çº§ï¼›å¹‚ç­‰é”®ï¼ˆIdempotency-Keyï¼‰
- å¯è§‚æµ‹ï¼šç»“æ„åŒ–æ—¥å¿—ã€æŒ‡æ ‡æ‰“ç‚¹ã€RunId ä¸²è”å…¨é“¾è·¯
- å¯æ‰©å±•ï¼šæ³¨å†Œä¸­å¿ƒ + æ’ä»¶åŒ–åŠ è½½ + ç‰ˆæœ¬ç®¡ç†ï¼ˆv1/v2ï¼‰

### 13.2 åŸºç¡€æ¥å£ä¸æ³¨å†Œä¸­å¿ƒ
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tooling/core.ts
import { Tool } from "@langchain/core/tools";
import { z } from "zod";

export interface ToolContext {
  userId: string;
  tenantId: string;
  auth?: Record<string, any>; // å·²æˆæƒçš„å‡­æ®/ä»¤ç‰Œ
  runId?: string;
}

export abstract class SafeTool<T extends z.ZodTypeAny> extends Tool {
  schema!: T;
  abstract _callWithContext(input: z.infer<T>, ctx: ToolContext): Promise<any>;

  async _call(input: any) { throw new Error("Use _callWithContext with ToolRunner"); }
}

export class ToolRegistry {
  private tools = new Map<string, SafeTool<any>>();
  register(t: SafeTool<any>) { this.tools.set(t.name, t); }
  get(name: string) { return this.tools.get(name); }
  list() { return [...this.tools.values()]; }
}

export class ToolRunner {
  constructor(private registry: ToolRegistry) {}
  async run(name: string, args: any, ctx: ToolContext) {
    const tool = this.registry.get(name);
    if (!tool) throw new Error(`å·¥å…·ä¸å­˜åœ¨: ${name}`);
    // åŸºç¡€ç­–ç•¥ï¼šè¶…æ—¶ã€é‡è¯•ã€é€Ÿç‡é™åˆ¶ã€å®¡è®¡
    return withTimeout(() => withRetry(() => tool._callWithContext(args, ctx), 2), 15_000);
  }
}

export async function withRetry<T>(fn: () => Promise<T>, tries = 2) {
  let last: any; for (let i=0;i<tries;i++){ try{ return await fn(); }catch(e){ last=e; await sleep(200*(i+1)); }}
  throw last;
}
export async function withTimeout<T>(fn: () => Promise<T>, ms: number) {
  let t: any; return Promise.race([fn(), new Promise((_,rej)=> t=setTimeout(()=>rej(new Error("timeout")), ms))]).finally(()=>clearTimeout(t));
}
export const sleep = (ms: number) => new Promise(r => setTimeout(r, ms));
```

---

## ğŸ” æˆæƒä¸å¯†é’¥ç®¡ç†ï¼ˆOAuth2/OIDC + KMSï¼‰

### 13.3 å‡­æ®æ¨¡å‹
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/auth/creds.ts
export type Credential = {
  provider: 'google'|'slack'|'jira'|'notion'|'github'|'outlook';
  tenantId: string; userId: string; scope: string[];
  accessToken: string; refreshToken?: string; expiresAt?: number; meta?: any;
};
```

### 13.4 Next.js OAuth å›è°ƒï¼ˆç¤ºæ„ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/app/api/oauth/callback/route.ts
import { NextRequest } from "next/server";
export const runtime = "edge";

export async function GET(req: NextRequest) {
  const url = new URL(req.url);
  const provider = url.searchParams.get('provider');
  const code = url.searchParams.get('code');
  // äº¤æ¢ tokenï¼ˆçœç•¥å…·ä½“å®ç°ï¼‰ï¼Œå†™å…¥åŠ å¯†å­˜å‚¨ï¼ˆKMS/Secrets Manager/DB KMS åˆ—ï¼‰
  // é‡å®šå‘åˆ°å·¥å…·æˆæƒæˆåŠŸé¡µé¢
  return new Response(null, { status: 302, headers: { Location: `/tools?provider=${provider}&ok=1` } });
}
```

### 13.5 å·¥å…·æ‰§è¡Œæ—¶æå–å‡­æ®
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/auth/context.ts
import { ToolContext } from "../tooling/core";

export async function buildToolContext(userId: string, tenantId: string): Promise<ToolContext> {
  // ä»å®‰å…¨å­˜å‚¨è¯»å–ç”¨æˆ·å·²æˆæƒçš„ç¬¬ä¸‰æ–¹å‡­æ®
  const auth = { google: { accessToken: "..." }, slack: { accessToken: "..." } };
  return { userId, tenantId, auth };
}
```

---

## ğŸ”Œ å¸¸ç”¨ä¼ä¸šå·¥å…·é€‚é…å®ç°

### 13.6 Google Calendarï¼ˆæ—¥ç¨‹ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tools/google-calendar.ts
import { z } from "zod";
import { SafeTool, ToolContext } from "../tooling/core";

export class GoogleCalendarTool extends SafeTool<typeof GoogleCalendarTool.schema> {
  name = "google_calendar";
  description = "åœ¨ Google Calendar ä¸­åˆ›å»ºä¼šè®®äº‹ä»¶";
  static schema = z.object({
    title: z.string(),
    start: z.string().describe("ISO æ—¶é—´"),
    end: z.string().describe("ISO æ—¶é—´"),
    attendees: z.array(z.string()).default([]),
    description: z.string().optional(),
  });
  schema = GoogleCalendarTool.schema;

  async _callWithContext(input: z.infer<typeof GoogleCalendarTool.schema>, ctx: ToolContext) {
    if (!ctx.auth?.google?.accessToken) throw new Error("æœªæˆæƒ Google");
    // ä¼ªè°ƒç”¨ï¼šå®é™…åº”è¯·æ±‚ Google Calendar API
    const eventId = `ev_${Date.now()}`;
    return { ok: true, eventId, link: `https://calendar.google.com/event?eid=${eventId}` };
  }
}
```

### 13.7 Slackï¼ˆæ¶ˆæ¯é€šçŸ¥ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tools/slack.ts
import { z } from "zod";
import { SafeTool, ToolContext } from "../tooling/core";

export class SlackNotifyTool extends SafeTool<typeof SlackNotifyTool.schema> {
  name = "slack_notify";
  description = "åœ¨ Slack é¢‘é“æˆ–ç”¨æˆ·å‘é€æ¶ˆæ¯";
  static schema = z.object({ channel: z.string(), text: z.string() });
  schema = SlackNotifyTool.schema;
  async _callWithContext(input: z.infer<typeof SlackNotifyTool.schema>, ctx: ToolContext) {
    if (!ctx.auth?.slack?.accessToken) throw new Error("æœªæˆæƒ Slack");
    // ä¼ªè°ƒç”¨ Slack chat.postMessage
    return { ok: true, ts: Date.now(), channel: input.channel };
  }
}
```

### 13.8 Jiraï¼ˆå·¥å•ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tools/jira.ts
import { z } from "zod";
import { SafeTool, ToolContext } from "../tooling/core";

export class JiraIssueTool extends SafeTool<typeof JiraIssueTool.schema> {
  name = "jira_create_issue";
  description = "åœ¨ Jira ä¸­åˆ›å»ºå·¥å•ï¼ˆç¤ºä¾‹é¡¹ç›® KEY=PROJï¼‰";
  static schema = z.object({
    summary: z.string(),
    description: z.string(),
    priority: z.enum(["Low","Medium","High"]).default("Medium"),
  });
  schema = JiraIssueTool.schema;
  async _callWithContext(input: z.infer<typeof JiraIssueTool.schema>, ctx: ToolContext) {
    // ä¼ªè°ƒç”¨ Jira REST API
    const key = `PROJ-${Math.floor(Math.random()*10000)}`;
    return { ok: true, key, url: `https://jira.example/browse/${key}` };
  }
}
```

### 13.9 Notionï¼ˆçŸ¥è¯†å¡ç‰‡ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tools/notion.ts
import { z } from "zod";
import { SafeTool, ToolContext } from "../tooling/core";

export class NotionPageTool extends SafeTool<typeof NotionPageTool.schema> {
  name = "notion_create_page";
  description = "åœ¨ Notion åˆ›å»ºä¼šè®®çºªè¦/çŸ¥è¯†å¡ç‰‡";
  static schema = z.object({ title: z.string(), content: z.string() });
  schema = NotionPageTool.schema;
  async _callWithContext(input: z.infer<typeof NotionPageTool.schema>, ctx: ToolContext) {
    const pageId = `pg_${Date.now()}`;
    return { ok: true, pageId, url: `https://notion.so/${pageId}` };
  }
}
```

### 13.10 Web æœç´¢ï¼ˆä»£ç†ï¼‰
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tools/search.ts
import { z } from "zod"; import { SafeTool, ToolContext } from "../tooling/core";
export class WebSearchTool extends SafeTool<typeof WebSearchTool.schema> {
  name = "web_search"; description = "é€šç”¨ Web æœç´¢ï¼ˆä»£ç†åˆ°è‡ªå»º/ç¬¬ä¸‰æ–¹æœç´¢æœåŠ¡ï¼‰";
  static schema = z.object({ query: z.string(), k: z.number().default(5) }); schema = WebSearchTool.schema;
  async _callWithContext(input: any, ctx: ToolContext) { return { results: Array.from({length: input.k}).map((_,i)=>({ title:`${input.query}-${i}`, url:`https://example.com/${i}`})) }; }
}
```

---

## ğŸ§  Agent Ã— å·¥å…·ï¼šè®¡åˆ’ä¸æ‰§è¡Œ

### 13.11 å·¥å…·æ³¨å†Œä¸æ‰§è¡Œç­–ç•¥
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/tooling/register.ts
import { ToolRegistry, ToolRunner } from "./core";
import { GoogleCalendarTool } from "../tools/google-calendar";
import { SlackNotifyTool } from "../tools/slack";
import { JiraIssueTool } from "../tools/jira";
import { NotionPageTool } from "../tools/notion";
import { WebSearchTool } from "../tools/search";

export function buildRegistry() {
  const reg = new ToolRegistry();
  [new GoogleCalendarTool(), new SlackNotifyTool(), new JiraIssueTool(), new NotionPageTool(), new WebSearchTool()].forEach(t=>reg.register(t));
  return { registry: reg, runner: new ToolRunner(reg) };
}
```

### 13.12 è®¡åˆ’ â†’ å¹¶è¡Œæ‰§è¡Œ â†’ å½’å¹¶
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/agent/plan-exec.ts
import { ChatOpenAI } from "@langchain/openai";
import { PromptTemplate } from "@langchain/core/prompts";
import { buildRegistry } from "../tooling/register";
import { buildToolContext } from "../auth/context";

const planPrompt = PromptTemplate.fromTemplate(`
å°†ç›®æ ‡åˆ†è§£ä¸ºå·¥å…·è°ƒç”¨æ­¥éª¤ï¼ˆJSONï¼‰: [{id, tool, args, description}]
ç›®æ ‡: {goal}
å¯ç”¨å·¥å…·: {tools}
è¾“å‡º: JSON æ•°ç»„
`);

export async function runPlanned(goal: string, userId: string, tenantId: string) {
  const llm = new ChatOpenAI({ temperature: 0 });
  const { registry, runner } = buildRegistry();
  const toolsDesc = registry.list().map(t=>`${t.name}: ${t.description}`).join("\n");
  const planRes = await planPrompt.pipe(llm).invoke({ goal, tools: toolsDesc });
  let steps: any[]; try { steps = JSON.parse(String(planRes.content)); } catch { steps = []; }

  const ctx = await buildToolContext(userId, tenantId);
  const results = await Promise.allSettled(steps.map(s => runner.run(s.tool, s.args, ctx)));
  return steps.map((s, i) => ({ step: s, result: results[i].status === 'fulfilled' ? results[i].value : { error: (results[i] as any).reason?.message } }));
}
```

---

## ğŸŒ³ LangGraph å¤šå·¥å…·åä½œï¼ˆå«å†²çªè§£å†³ï¼‰

### 13.13 çŠ¶æ€ä¸èŠ‚ç‚¹
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/graph/state.ts
export type CoopState = {
  goal: string;
  plan?: any[];
  exec?: Array<{ step: any; result: any }>;
  merged?: any;
  conflict?: { reason: string; details: any };
  timeline: any[];
};
```

```typescript
// æ–‡ä»¶ï¼šsrc/ch13/graph/nodes.ts
import { StateGraph } from "@langchain/langgraph";
import { ChatOpenAI } from "@langchain/openai";
import { PromptTemplate } from "@langchain/core/prompts";
import { runPlanned } from "../agent/plan-exec";
import { CoopState } from "./state";

export async function planNode(s: CoopState): Promise<Partial<CoopState>> {
  const out = await runPlanned(`è¯·å®Œæˆï¼š${s.goal}`, 'u1', 't1');
  return { exec: out, timeline: [{ type: 'exec', at: Date.now(), data: out }] };
}

const mergePrompt = PromptTemplate.fromTemplate(`
ç»™å®šå¤šå·¥å…·ç»“æœï¼Œæ•´åˆä¸ºæœ€ç»ˆç»“æ„ï¼š
è¾“å…¥: {results}
è¾“å‡ºJSON: {"summary": string, "actions": string[]}
`);

export async function mergeNode(s: CoopState): Promise<Partial<CoopState>> {
  const llm = new ChatOpenAI({ temperature: 0.2 });
  const res = await mergePrompt.pipe(llm).invoke({ results: JSON.stringify(s.exec) });
  let merged: any; try { merged = JSON.parse(String(res.content)); } catch { merged = { summary: String(res.content) }; }
  return { merged, timeline: [{ type: 'merge', at: Date.now(), data: merged }] };
}

const conflictPrompt = PromptTemplate.fromTemplate(`
æ£€æŸ¥æ˜¯å¦å­˜åœ¨å†²çªï¼ˆæ—¶é—´å†²çª/é‡å¤é€šçŸ¥/æƒé™ä¸è¶³ï¼‰ï¼Œè¾“å‡ºï¼š{"conflict": boolean, "reason": string}
è¾“å…¥: {merged}
`);

export async function conflictNode(s: CoopState): Promise<Partial<CoopState>> {
  const llm = new ChatOpenAI({ temperature: 0 });
  const res = await conflictPrompt.pipe(llm).invoke({ merged: JSON.stringify(s.merged) });
  let j: any; try { j = JSON.parse(String(res.content)); } catch { j = { conflict: false }; }
  return j.conflict ? { conflict: { reason: j.reason, details: s.merged } } : { };
}
```

### 13.14 å›¾ä¸æ¡ä»¶æµ
```typescript
// æ–‡ä»¶ï¼šsrc/ch13/graph/app.ts
import { StateGraph } from "@langchain/langgraph";
import { CoopState } from "./state";
import { planNode, mergeNode, conflictNode } from "./nodes";

export async function buildCoopGraph() {
  const g = new StateGraph<CoopState>({ channels: {
    goal: { value: "" }, plan: { value: [] }, exec: { value: [] }, merged: { value: {} }, conflict: { value: undefined }, timeline: { value: [], merge: (a,b)=>[...a,...b] }
  }});
  g.addNode('plan', planNode);
  g.addNode('merge', mergeNode);
  g.addNode('conflict', conflictNode);
  g.addEdge('start','plan'); g.addEdge('plan','merge');
  g.addConditionalEdges('merge', s => s.merged ? 'conflict' : 'end', { conflict: 'conflict' });
  g.addConditionalEdges('conflict', s => s.conflict ? 'end' : 'end', {});
  return g.compile();
}
```

---

## ğŸŒ Next.js é›†æˆï¼šæˆæƒé¡µã€æ‰§è¡Œ API ä¸å¯è§†åŒ–

### 13.15 æˆæƒé¡µï¼ˆå‰ç«¯ï¼‰
```tsx
// æ–‡ä»¶ï¼šsrc/app/tools/page.tsx
"use client";
export default function ToolsPage() {
  const providers = [
    { id: 'google', name: 'Google Calendar' },
    { id: 'slack', name: 'Slack' },
    { id: 'jira', name: 'Jira' },
    { id: 'notion', name: 'Notion' },
  ];
  return (
    <main className="max-w-3xl mx-auto p-4 space-y-4">
      <h1 className="text-2xl font-bold">å·¥å…·æˆæƒ</h1>
      <ul className="space-y-2">
        {providers.map(p => (
          <li key={p.id} className="flex items-center justify-between border rounded p-3">
            <div>{p.name}</div>
            <a className="px-3 py-1 rounded bg-blue-600 text-white" href={`/api/oauth/callback?provider=${p.id}`}>æˆæƒ</a>
          </li>
        ))}
      </ul>
    </main>
  );
}
```

### 13.16 æ‰§è¡Œ API
```typescript
// æ–‡ä»¶ï¼šsrc/app/api/coop/route.ts
import { NextRequest } from "next/server";
import { buildCoopGraph } from "@/src/ch13/graph/app";
export const runtime = "edge";

export async function POST(req: NextRequest) {
  const { goal } = await req.json();
  const app = await buildCoopGraph();
  const out = await app.invoke({ goal, timeline: [] });
  return Response.json({ ok: true, data: out });
}
```

### 13.17 å¯è§†åŒ–é¡µé¢
```tsx
// æ–‡ä»¶ï¼šsrc/app/coop/page.tsx
"use client";
import { useState } from "react";

export default function CoopPage(){
  const [goal, setGoal] = useState("");
  const [data, setData] = useState<any>(null);
  const run = async ()=>{
    const res = await fetch('/api/coop', { method:'POST', body: JSON.stringify({ goal }) });
    const json = await res.json(); setData(json.data);
  };
  return (
    <main className="max-w-3xl mx-auto p-4 space-y-3">
      <h1 className="text-2xl font-bold">ä¼ä¸šååŒåŠ©æ‰‹</h1>
      <div className="flex gap-2">
        <input className="flex-1 border rounded px-3 py-2" value={goal} onChange={e=>setGoal(e.target.value)} placeholder="ä¾‹å¦‚ï¼šå®‰æ’æœ¬å‘¨å›¢é˜Ÿä¼šè®®å¹¶å‘é€é€šçŸ¥ï¼Œè®°å½•çºªè¦ï¼Œè‹¥æœ‰é—®é¢˜åˆ›å»ºå·¥å•" />
        <button onClick={run} className="px-4 py-2 bg-blue-600 text-white rounded">è¿è¡Œ</button>
      </div>
      {data && <pre className="whitespace-pre-wrap break-words text-sm bg-gray-50 p-3 rounded">{JSON.stringify(data, null, 2)}</pre>}
    </main>
  );
}
```

---

## ğŸš€ å®æˆ˜ï¼šä¼ä¸šååŒåŠ©æ‰‹ï¼ˆä¼šè®®å®‰æ’ + çºªè¦ + å·¥å• + é€šçŸ¥ï¼‰

### 13.18 åœºæ™¯æè¿°
- è¾“å…¥ï¼šè‡ªç„¶è¯­è¨€ç›®æ ‡ï¼Œä¾‹å¦‚â€œå®‰æ’å‘¨ä¸‰ä¸‹åˆ30åˆ†é’Ÿè¯„å®¡ä¼šï¼Œå‚ä¸ A/B/Cï¼›ä¼šåå‡ºçºªè¦å¹¶å°† action items ç”Ÿæˆ Jira å·¥å•ï¼›åœ¨ Slack é€šçŸ¥å›¢é˜Ÿã€‚â€
- æµç¨‹ï¼šè®¡åˆ’ â†’ åˆ›å»ºæ—¥å† â†’ ç”Ÿæˆçºªè¦æ¨¡ç‰ˆ â†’ åˆ›å»ºå·¥å• â†’ å‘é€é€šçŸ¥ â†’ å›æ‰§
- å®ˆæŠ¤ï¼šæƒé™æ£€æŸ¥/æ—¶é—´å†²çª/é‡å¤é€šçŸ¥/å¤±è´¥é‡è¯•/äººå·¥ç¡®è®¤

### 13.19 å…³é”®ç­–ç•¥
- å¹‚ç­‰ï¼šå¯¹åŒä¸€ `goal + time` ç”Ÿæˆç›¸åŒ `Idempotency-Key`ï¼Œé¿å…é‡å¤
- å®‰å…¨ï¼šOAuth scope æœ€å°åŒ–ï¼›å·¥å…·å‚æ•°ç™½åå•ï¼›å¯¹å¤–é“¾æ¥æ£€æµ‹
- å¯è§‚æµ‹ï¼šæ¯æ­¥è®¡æ—¶ã€é”™è¯¯åˆ†ç±»ã€ç»“æœå›æ”¾ï¼ˆå«å¤–éƒ¨é“¾æ¥å’Œå“åº”æ‘˜è¦ï¼‰

### 13.20 ç¤ºä¾‹æ‰§è¡Œï¼ˆä¼ªï¼‰
```json
{
  "goal": "å®‰æ’å‘¨ä¸‰è¯„å®¡ä¼š+çºªè¦+å·¥å•+é€šçŸ¥",
  "timeline": [
    {"type":"exec","at":1710000000,"data":[{"step":{"id":1,"tool":"google_calendar"},"result":{"ok":true,"eventId":"ev_..."}}]},
    {"type":"exec","at":1710000100,"data":[{"step":{"id":2,"tool":"notion_create_page"},"result":{"ok":true,"pageId":"pg_..."}}]},
    {"type":"exec","at":1710000200,"data":[{"step":{"id":3,"tool":"jira_create_issue"},"result":{"ok":true,"key":"PROJ-123"}}]},
    {"type":"exec","at":1710000300,"data":[{"step":{"id":4,"tool":"slack_notify"},"result":{"ok":true,"channel":"#team"}}]}
  ],
  "merged": {"summary":"ä¼šè®®å·²å®‰æ’ï¼Œçºªè¦åˆ›å»ºï¼Œå·¥å•ç”Ÿæˆï¼Œå·²é€šçŸ¥"}
}
```

---

## âš™ï¸ å·¥ç¨‹åŒ–ï¼šé…é¢ã€é™æµã€å®¡è®¡ä¸æ²™ç®±

### 13.21 é…é¢ä¸é™æµ
- ç»´åº¦ï¼šæŒ‰ç§Ÿæˆ·/ç”¨æˆ·/å·¥å…·/åˆ†é’Ÿ/å¤©ï¼›è¶…é™åè½¯æ€§é™çº§æˆ–ç¡¬æ€§æ‹’ç»
- å…±äº«é¢åº¦ï¼šå›¢é˜Ÿçº§æ± åŒ–ï¼›å…³é”®å·¥å…·ç‹¬ç«‹é¢åº¦ï¼ˆå¦‚ Calendarï¼‰

### 13.22 å®¡è®¡ä¸å›æ”¾
- è®°å½•ï¼šè¾“å…¥ã€è°ƒç”¨å‚æ•°ã€å“åº”æ‘˜è¦ã€å¤–éƒ¨é“¾æ¥ã€æ“ä½œè€…ä¸ RunId
- å›æ”¾ï¼šæ•æ„Ÿå·¥å…·éœ€åŒäººå¤æ ¸æ¨¡å¼ï¼ˆå››çœ¼åŸåˆ™ï¼‰

### 13.23 æ²™ç®±ä¸ç­–ç•¥
- ä»£ç æ‰§è¡Œå·¥å…·éœ€å¼ºæ²™ç®±ï¼ˆè§ç¬¬8ç« ï¼‰ï¼Œç¦æ­¢æ–‡ä»¶/ç½‘ç»œ/ç³»ç»Ÿè°ƒç”¨
- ç”Ÿæˆç±»å·¥å…·è¾“å‡ºéœ€æ­£åˆ™/ç­–ç•¥æ£€æŸ¥ï¼ˆæ•æ„Ÿè¯/æ³„éœ²æ£€æµ‹ï¼‰

---

## ğŸ§ª æµ‹è¯•ä¸éªŒæ”¶

### 13.24 å·¥å…·çº§æµ‹è¯•
- å•å…ƒæµ‹è¯•ï¼šå‚æ•°æ ¡éªŒã€é”™è¯¯è·¯å¾„ã€é‡è¯•ä¸è¶…æ—¶
- é›†æˆæµ‹è¯•ï¼šOAuth æˆæƒå›è°ƒã€ä»¤ç‰Œåˆ·æ–°ã€æƒé™æ‹’ç»

### 13.25 ç«¯åˆ°ç«¯å›å½’
- åœºæ™¯è„šæœ¬ï¼šå¸¸è§ååŒä»»åŠ¡çš„é»„é‡‘é›†ï¼›æ¯”å¯¹æˆåŠŸç‡ã€å¹³å‡ç”¨æ—¶ã€å¤±è´¥åˆ†ç±»
- ç°åº¦ç­–ç•¥ï¼šæ–°å·¥å…·/æ–°ç‰ˆæœ¬å…ˆå°æµé‡è¯•è¿è¡Œï¼Œè§‚æµ‹ç¨³å®šåå…¨é‡

---

## ğŸ“š å»¶ä¼¸é“¾æ¥
- Google Calendar APIï¼š`https://developers.google.com/calendar/api`
- Slack APIï¼š`https://api.slack.com/`
- Jira REST APIï¼š`https://developer.atlassian.com/cloud/jira/platform/rest/v3/`
- Notion APIï¼š`https://developers.notion.com/`
- OAuth 2.0ï¼š`https://oauth.net/2/`

---

## âœ… æœ¬ç« å°ç»“
- æ„å»ºäº†å®‰å…¨å¯æ‰©å±•çš„å·¥å…·é€‚é…å±‚ä¸æ³¨å†Œæ‰§è¡Œæ¡†æ¶
- é›†æˆå¸¸ç”¨ä¼ä¸šå·¥å…·ï¼ˆæ—¥å†/æ¶ˆæ¯/å·¥å•/æ–‡æ¡£/æœç´¢ï¼‰å¹¶ä¸ Agent åä½œ
- ç”¨ LangGraph ç¼–æ’å¤šå·¥å…·ç»“æœå¹¶è¿›è¡Œå†²çªæ£€æµ‹ä¸å½’å¹¶
- åœ¨ Next.js ä¸­å®ç°æˆæƒã€æ‰§è¡Œä¸å¯è§†åŒ–ï¼Œå®Œæˆä¼ä¸šååŒåŠ©æ‰‹å®æˆ˜

## ğŸ¯ ä¸‹ç« é¢„å‘Š
ä¸‹ä¸€ç« ã€Šç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ä¸ DevOps å®è·µã€‹ä¸­ï¼Œæˆ‘ä»¬å°†ï¼š
- è®¾è®¡å¤šç¯å¢ƒéƒ¨ç½²ä¸å¯†é’¥ç®¡ç†
- æ„å»º CI/CD ä¸ç°åº¦å›æ»š
- æ‰“é€ ç”Ÿäº§çº§å¯è§‚æµ‹ä¸å‘Šè­¦

> æœ€åæ„Ÿè°¢é˜…è¯»ï¼æ¬¢è¿å…³æ³¨æˆ‘ï¼Œå¾®ä¿¡å…¬ä¼—å·ï¼š`ã€Šé²«å°é±¼ä¸æ­£ç»ã€‹`ã€‚æ¬¢è¿ç‚¹èµã€æ”¶è—ã€å…³æ³¨ï¼Œä¸€é”®ä¸‰è¿ï¼ï¼ï¼
